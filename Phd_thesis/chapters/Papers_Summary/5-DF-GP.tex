\chapter{Disturbance Modeling Using Gaussian Processes with Dynamic Forgetting Factors}
\label{ch:dfgp}

In this chapter, we address the challenge of disturbance modeling in marine robotics. Rather than learning the full system dynamics, we assume a known nominal model derived from first principles and explicitly learn the residual disturbances that affect system performance. These environmental disturbances can significantly degrade trajectory tracking for MPC. 

To address this, we propose a data-efficient approach using Gaussian Processes (GPs) to learn only the unmodeled effects. Recognizing that underwater disturbances evolve over multiple timescales, we introduce a novel Dynamic Forgetting Gaussian Process (DF-GP) framework. This method avoids costly hyperparameter retuning by combining the predictions of multiple GPs, each with tailored forgetting factors. The resulting disturbance estimates are used to update the predictive model within MPC, enhancing tracking accuracy across diverse underwater conditions.



%In this work, we learn the residuals of the system dynamics, assuming a known nominal model. This approach is more data-efficient since we only learn the unmodeled effectsâ€”specifically, disturbances impacting crucial aspects of the system. Particularly in underwater environments, disturbances vary over multiple timescales. To handle this, we propose a novel dynamic forgetting GP (DF-GP) methodology that compensates for operational disturbances without requiring hyperparameter retuning. This method optimally combines the predictions of several GPs designed with handcrafted forgetting factors, enabling precise disturbance estimation across varying timescales. The predicted disturbances update the model parameters within MPC, enabling a learning-based control framework that ensures accurate tracking in different underwater scenarios.

The key contributions of this study are:

\begin{itemize}
\item A learning-based MPC framework built upon a GP architecture that facilitates efficient disturbance learning of varying timescales along with unmodeled uncertainties.
\item An online adaptive framework that optimally weighs the predictions of multiple GPs with varying forgetting factors.
\item Validation of the proposed framework through extensive simulations and real-world experiments demonstrating improved performance.
\end{itemize}

Rigorous simulation and experimental results show a 25\% improvement in disturbance estimation and tracking performance, outperforming direct competitors.